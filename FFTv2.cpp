#include "stdafx.h"
#include <cstdint>
#include <iostream>

//2*pi/N is abstracted out of this sinArr
int32_t sinArr[] = { 0,6588386,13176711,19764912,26352927,32940694,39528151,46115236,52701886,59288041,65873638,72458614,79042909,85626459,92209204,98791081,105372028,111951983,118530884,125108670,131685278,138260647,144834714,151407418,157978697,164548489,171116732,177683365,184248325,190811551,197372981,203932553,210490205,217045877,223599506,230151030,236700387,243247517,249792357,256334846,262874923,269412525,275947591,282480060,289009870,295536960,302061268,308582733,315101294,321616889,328129456,334638935,341145265,347648383,354148229,360644742,367137860,373627522,380113668,386596236,393075166,399550395,406021864,412489511,418953276,425413097,431868914,438320666,444768293,451211733,457650927,464085812,470516330,476942419,483364018,489781068,496193509,502601278,509004317,515402565,521795962,528184448,534567962,540946445,547319836,553688075,560051103,566408859,572761285,579108319,585449902,591785975,598116478,604441351,610760535,617073970,623381597,629683356,635979189,642269036,648552837,654830534,661102067,667367378,673626407,679879096,686125386,692365217,698598532,704825271,711045377,717258789,723465451,729665302,735858286,742044344,748223418,754395449,760560379,766718150,772868705,779011985,785147933,791276491,797397601,803511206,809617248,815715669,821806412,827889421,833964637,840032003,846091463,852142958,858186434,864221831,870249094,876268167,882278991,888281511,894275670,900261412,906238680,912207418,918167571,924119081,930061893,935995951,941921199,947837581,953745042,959643526,965532977,971413341,977284561,983146582,988999350,994842809,1000676904,1006501580,1012316783,1018122458,1023918549,1029705003,1035481765,1041248781,1047005996,1052753356,1058490807,1064218295,1069935767,1075643168,1081340444,1087027543,1092704410,1098370992,1104027236,1109673088,1115308495,1120933405,1126547764,1132151520,1137744620,1143327010,1148898639,1154459455,1160009404,1165548434,1171076494,1176593532,1182099495,1187594331,1193077990,1198550418,1204011566,1209461381,1214899812,1220326808,1225742317,1231146290,1236538674,1241919420,1247288476,1252645793,1257991319,1263325004,1268646799,1273956652,1279254514,1284540336,1289814067,1295075658,1300325059,1305562221,1310787094,1315999630,1321199779,1326387493,1331562722,1336725418,1341875532,1347013016,1352137821,1357249900,1362349203,1367435684,1372509293,1377569984,1382617709,1387652420,1392674071,1397682612,1402677998,1407660182,1412629116,1417584754,1422527049,1427455955,1432371425,1437273413,1442161873,1447036759,1451898024,1456745624,1461579512,1466399644,1471205973,1475998454,1480777043,1485541694,1490292363,1495029005,1499751575,1504460028,1509154321,1513834409,1518500249,1523151796,1527789006,1532411836,1537020242,1541614182,1546193611,1550758487,1555308767,1559844407,1564365365,1568871600,1573363067,1577839725,1582301532,1586748446,1591180424,1595597426,1599999410,1604386334,1608758156,1613114836,1617456334,1621782607,1626093615,1630389317,1634669674,1638934645,1643184190,1647418268,1651636840,1655839866,1660027307,1664199123,1668355275,1672495724,1676620430,1680729356,1684822462,1688899710,1692961061,1697006477,1701035921,1705049354,1709046738,1713028036,1716993210,1720942223,1724875039,1728791618,1732691926,1736575926,1740443579,1744294851,1748129706,1751948106,1755750016,1759535400,1763304223,1767056449,1770792043,1774510969,1778213193,1781898680,1785567395,1789219303,1792854371,1796472564,1800073847,1803658188,1807225552,1810775905,1814309215,1817825448,1821324571,1824806550,1828271354,1831718950,1835149305,1838562387,1841958163,1845336602,1848697672,1852041342,1855367579,1858676353,1861967633,1865241387,1868497584,1871736195,1874957188,1878160533,1881346200,1884514160,1887664381,1890796835,1893911493,1897008324,1900087299,1903148391,1906191569,1909216805,1912224071,1915213339,1918184579,1921137766,1924072869,1926989863,1929888719,1932769410,1935631909,1938476189,1941302224,1944109986,1946899449,1949670588,1952423376,1955157786,1957873794,1960571374,1963250500,1965911147,1968553290,1971176905,1973781966,1976368449,1978936329,1981485584,1984016187,1986528117,1989021348,1991495858,1993951623,1996388621,1998806828,2001206221,2003586778,2005948476,2008291294,2010615209,2012920199,2015206243,2017473319,2019721406,2021950482,2024160527,2026351520,2028523440,2030676267,2032809981,2034924560,2037019987,2039096240,2041153300,2043191148,2045209765,2047209132,2049189229,2051150039,2053091543,2055013722,2056916558,2058800034,2060664132,2062508834,2064334123,2066139982,2067926393,2069693340,2071440807,2073168776,2074877232,2076566158,2078235539,2079885359,2081515602,2083126253,2084717297,2086288718,2087840503,2089372636,2090885104,2092377891,2093850983,2095304368,2096738031,2098151959,2099546137,2100920555,2102275197,2103610052,2104925108,2106220350,2107495769,2108751350,2109987084,2111202957,2112398959,2113575078,2114731304,2115867624,2116984030,2118080509,2119157053,2120213650,2121250290,2122266965,2123263664,2124240379,2125197099,2126133816,2127050521,2127947205,2128823860,2129680478,2130517051,2131333570,2132130028,2132906418,2133662733,2134398964,2135115106,2135811151,2136487093,2137142926,2137778643,2138394238,2138989706,2139565041,2140120238,2140655291,2141170196,2141664947,2142139539,2142593969,2143028233,2143442325,2143836242,2144209981,2144563537,2144896908,2145210091,2145503082,2145775879,2146028478,2146260879,2146473078,2146665074,2146836865,2146988448,2147119824,2147230990,2147321945,2147392689,2147443221,2147473540,2147483647,2147473540,2147443221,2147392689,2147321945,2147230990,2147119824,2146988448,2146836865,2146665074,2146473078,2146260879,2146028478,2145775879,2145503082,2145210091,2144896908,2144563537,2144209981,2143836242,2143442325,2143028233,2142593969,2142139539,2141664947,2141170196,2140655291,2140120238,2139565041,2138989706,2138394238,2137778643,2137142926,2136487093,2135811151,2135115106,2134398964,2133662733,2132906418,2132130028,2131333570,2130517051,2129680478,2128823860,2127947205,2127050521,2126133816,2125197099,2124240379,2123263664,2122266965,2121250290,2120213650,2119157053,2118080509,2116984030,2115867624,2114731304,2113575078,2112398959,2111202957,2109987084,2108751350,2107495769,2106220350,2104925108,2103610052,2102275197,2100920555,2099546137,2098151959,2096738031,2095304368,2093850983,2092377891,2090885104,2089372636,2087840503,2086288718,2084717297,2083126253,2081515602,2079885359,2078235539,2076566158,2074877232,2073168776,2071440807,2069693340,2067926393,2066139982,2064334123,2062508834,2060664132,2058800034,2056916558,2055013722,2053091543,2051150039,2049189229,2047209132,2045209765,2043191148,2041153300,2039096240,2037019987,2034924560,2032809981,2030676267,2028523440,2026351520,2024160527,2021950482,2019721406,2017473319,2015206243,2012920199,2010615209,2008291294,2005948476,2003586778,2001206221,1998806828,1996388621,1993951623,1991495858,1989021348,1986528117,1984016187,1981485584,1978936329,1976368449,1973781966,1971176905,1968553290,1965911147,1963250500,1960571374,1957873794,1955157786,1952423376,1949670588,1946899449,1944109986,1941302224,1938476189,1935631909,1932769410,1929888719,1926989863,1924072869,1921137766,1918184579,1915213339,1912224071,1909216805,1906191569,1903148391,1900087299,1897008324,1893911493,1890796835,1887664381,1884514160,1881346200,1878160533,1874957188,1871736195,1868497584,1865241387,1861967633,1858676353,1855367579,1852041342,1848697672,1845336602,1841958163,1838562387,1835149305,1831718950,1828271354,1824806550,1821324571,1817825448,1814309215,1810775905,1807225552,1803658188,1800073847,1796472564,1792854371,1789219303,1785567395,1781898680,1778213193,1774510969,1770792043,1767056449,1763304223,1759535400,1755750016,1751948106,1748129706,1744294851,1740443579,1736575926,1732691926,1728791618,1724875039,1720942223,1716993210,1713028036,1709046738,1705049354,1701035921,1697006477,1692961061,1688899710,1684822462,1680729356,1676620430,1672495724,1668355275,1664199123,1660027307,1655839866,1651636840,1647418268,1643184190,1638934645,1634669674,1630389317,1626093615,1621782607,1617456334,1613114836,1608758156,1604386334,1599999410,1595597426,1591180424,1586748446,1582301532,1577839725,1573363067,1568871600,1564365365,1559844407,1555308767,1550758487,1546193611,1541614182,1537020242,1532411836,1527789006,1523151796,1518500249,1513834409,1509154321,1504460028,1499751575,1495029005,1490292363,1485541694,1480777043,1475998454,1471205973,1466399644,1461579512,1456745624,1451898024,1447036759,1442161873,1437273413,1432371425,1427455955,1422527049,1417584754,1412629116,1407660182,1402677998,1397682612,1392674071,1387652420,1382617709,1377569984,1372509293,1367435684,1362349203,1357249900,1352137821,1347013016,1341875532,1336725418,1331562722,1326387493,1321199779,1315999630,1310787094,1305562221,1300325059,1295075658,1289814067,1284540336,1279254514,1273956652,1268646799,1263325004,1257991319,1252645793,1247288476,1241919420,1236538674,1231146290,1225742317,1220326808,1214899812,1209461381,1204011566,1198550418,1193077990,1187594331,1182099495,1176593532,1171076494,1165548434,1160009404,1154459455,1148898639,1143327010,1137744620,1132151520,1126547764,1120933405,1115308495,1109673088,1104027236,1098370992,1092704410,1087027543,1081340444,1075643168,1069935767,1064218295,1058490807,1052753356,1047005996,1041248781,1035481765,1029705003,1023918549,1018122458,1012316783,1006501580,1000676904,994842809,988999350,983146582,977284561,971413341,965532977,959643526,953745042,947837581,941921199,935995951,930061893,924119081,918167571,912207418,906238680,900261412,894275670,888281511,882278991,876268167,870249094,864221831,858186434,852142958,846091463,840032003,833964637,827889421,821806412,815715669,809617248,803511206,797397601,791276491,785147933,779011985,772868705,766718150,760560379,754395449,748223418,742044344,735858286,729665302,723465451,717258789,711045377,704825271,698598532,692365217,686125386,679879096,673626407,667367378,661102067,654830534,648552837,642269036,635979189,629683356,623381597,617073970,610760535,604441351,598116478,591785975,585449902,579108319,572761285,566408859,560051103,553688075,547319836,540946445,534567962,528184448,521795962,515402565,509004317,502601278,496193509,489781068,483364018,476942419,470516330,464085812,457650927,451211733,444768293,438320666,431868914,425413097,418953276,412489511,406021864,399550395,393075166,386596236,380113668,373627522,367137860,360644742,354148229,347648383,341145265,334638935,328129456,321616889,315101294,308582733,302061268,295536960,289009870,282480060,275947591,269412525,262874923,256334846,249792357,243247517,236700387,230151030,223599506,217045877,210490205,203932553,197372981,190811551,184248325,177683365,171116732,164548489,157978697,151407418,144834714,138260647,131685278,125108670,118530884,111951983,105372028,98791081,92209204,85626459,79042909,72458614,65873638,59288041,52701886,46115236,39528151,32940694,26352927,19764912,13176711,6588386,0,-6588386,-13176711,-19764912,-26352927,-32940694,-39528151,-46115236,-52701886,-59288041,-65873638,-72458614,-79042909,-85626459,-92209204,-98791081,-105372028,-111951983,-118530884,-125108670,-131685278,-138260647,-144834714,-151407418,-157978697,-164548489,-171116732,-177683365,-184248325,-190811551,-197372981,-203932553,-210490205,-217045877,-223599506,-230151030,-236700387,-243247517,-249792357,-256334846,-262874923,-269412525,-275947591,-282480060,-289009870,-295536960,-302061268,-308582733,-315101294,-321616889,-328129456,-334638935,-341145265,-347648383,-354148229,-360644742,-367137860,-373627522,-380113668,-386596236,-393075166,-399550395,-406021864,-412489511,-418953276,-425413097,-431868914,-438320666,-444768293,-451211733,-457650927,-464085812,-470516330,-476942419,-483364018,-489781068,-496193509,-502601278,-509004317,-515402565,-521795962,-528184448,-534567962,-540946445,-547319836,-553688075,-560051103,-566408859,-572761285,-579108319,-585449902,-591785975,-598116478,-604441351,-610760535,-617073970,-623381597,-629683356,-635979189,-642269036,-648552837,-654830534,-661102067,-667367378,-673626407,-679879096,-686125386,-692365217,-698598532,-704825271,-711045377,-717258789,-723465451,-729665302,-735858286,-742044344,-748223418,-754395449,-760560379,-766718150,-772868705,-779011985,-785147933,-791276491,-797397601,-803511206,-809617248,-815715669,-821806412,-827889421,-833964637,-840032003,-846091463,-852142958,-858186434,-864221831,-870249094,-876268167,-882278991,-888281511,-894275670,-900261412,-906238680,-912207418,-918167571,-924119081,-930061893,-935995951,-941921199,-947837581,-953745042,-959643526,-965532977,-971413341,-977284561,-983146582,-988999350,-994842809,-1000676904,-1006501580,-1012316783,-1018122458,-1023918549,-1029705003,-1035481765,-1041248781,-1047005996,-1052753356,-1058490807,-1064218295,-1069935767,-1075643168,-1081340444,-1087027543,-1092704410,-1098370992,-1104027236,-1109673088,-1115308495,-1120933405,-1126547764,-1132151520,-1137744620,-1143327010,-1148898639,-1154459455,-1160009404,-1165548434,-1171076494,-1176593532,-1182099495,-1187594331,-1193077990,-1198550418,-1204011566,-1209461381,-1214899812,-1220326808,-1225742317,-1231146290,-1236538674,-1241919420,-1247288476,-1252645793,-1257991319,-1263325004,-1268646799,-1273956652,-1279254514,-1284540336,-1289814067,-1295075658,-1300325059,-1305562221,-1310787094,-1315999630,-1321199779,-1326387493,-1331562722,-1336725418,-1341875532,-1347013016,-1352137821,-1357249900,-1362349203,-1367435684,-1372509293,-1377569984,-1382617709,-1387652420,-1392674071,-1397682612,-1402677998,-1407660182,-1412629116,-1417584754,-1422527049,-1427455955,-1432371425,-1437273413,-1442161873,-1447036759,-1451898024,-1456745624,-1461579512,-1466399644,-1471205973,-1475998454,-1480777043,-1485541694,-1490292363,-1495029005,-1499751575,-1504460028,-1509154321,-1513834409,-1518500249,-1523151796,-1527789006,-1532411836,-1537020242,-1541614182,-1546193611,-1550758487,-1555308767,-1559844407,-1564365365,-1568871600,-1573363067,-1577839725,-1582301532,-1586748446,-1591180424,-1595597426,-1599999410,-1604386334,-1608758156,-1613114836,-1617456334,-1621782607,-1626093615,-1630389317,-1634669674,-1638934645,-1643184190,-1647418268,-1651636840,-1655839866,-1660027307,-1664199123,-1668355275,-1672495724,-1676620430,-1680729356,-1684822462,-1688899710,-1692961061,-1697006477,-1701035921,-1705049354,-1709046738,-1713028036,-1716993210,-1720942223,-1724875039,-1728791618,-1732691926,-1736575926,-1740443579,-1744294851,-1748129706,-1751948106,-1755750016,-1759535400,-1763304223,-1767056449,-1770792043,-1774510969,-1778213193,-1781898680,-1785567395,-1789219303,-1792854371,-1796472564,-1800073847,-1803658188,-1807225552,-1810775905,-1814309215,-1817825448,-1821324571,-1824806550,-1828271354,-1831718950,-1835149305,-1838562387,-1841958163,-1845336602,-1848697672,-1852041342,-1855367579,-1858676353,-1861967633,-1865241387,-1868497584,-1871736195,-1874957188,-1878160533,-1881346200,-1884514160,-1887664381,-1890796835,-1893911493,-1897008324,-1900087299,-1903148391,-1906191569,-1909216805,-1912224071,-1915213339,-1918184579,-1921137766,-1924072869,-1926989863,-1929888719,-1932769410,-1935631909,-1938476189,-1941302224,-1944109986,-1946899449,-1949670588,-1952423376,-1955157786,-1957873794,-1960571374,-1963250500,-1965911147,-1968553290,-1971176905,-1973781966,-1976368449,-1978936329,-1981485584,-1984016187,-1986528117,-1989021348,-1991495858,-1993951623,-1996388621,-1998806828,-2001206221,-2003586778,-2005948476,-2008291294,-2010615209,-2012920199,-2015206243,-2017473319,-2019721406,-2021950482,-2024160527,-2026351520,-2028523440,-2030676267,-2032809981,-2034924560,-2037019987,-2039096240,-2041153300,-2043191148,-2045209765,-2047209132,-2049189229,-2051150039,-2053091543,-2055013722,-2056916558,-2058800034,-2060664132,-2062508834,-2064334123,-2066139982,-2067926393,-2069693340,-2071440807,-2073168776,-2074877232,-2076566158,-2078235539,-2079885359,-2081515602,-2083126253,-2084717297,-2086288718,-2087840503,-2089372636,-2090885104,-2092377891,-2093850983,-2095304368,-2096738031,-2098151959,-2099546137,-2100920555,-2102275197,-2103610052,-2104925108,-2106220350,-2107495769,-2108751350,-2109987084,-2111202957,-2112398959,-2113575078,-2114731304,-2115867624,-2116984030,-2118080509,-2119157053,-2120213650,-2121250290,-2122266965,-2123263664,-2124240379,-2125197099,-2126133816,-2127050521,-2127947205,-2128823860,-2129680478,-2130517051,-2131333570,-2132130028,-2132906418,-2133662733,-2134398964,-2135115106,-2135811151,-2136487093,-2137142926,-2137778643,-2138394238,-2138989706,-2139565041,-2140120238,-2140655291,-2141170196,-2141664947,-2142139539,-2142593969,-2143028233,-2143442325,-2143836242,-2144209981,-2144563537,-2144896908,-2145210091,-2145503082,-2145775879,-2146028478,-2146260879,-2146473078,-2146665074,-2146836865,-2146988448,-2147119824,-2147230990,-2147321945,-2147392689,-2147443221,-2147473540,-2147483647,-2147473540,-2147443221,-2147392689,-2147321945,-2147230990,-2147119824,-2146988448,-2146836865,-2146665074,-2146473078,-2146260879,-2146028478,-2145775879,-2145503082,-2145210091,-2144896908,-2144563537,-2144209981,-2143836242,-2143442325,-2143028233,-2142593969,-2142139539,-2141664947,-2141170196,-2140655291,-2140120238,-2139565041,-2138989706,-2138394238,-2137778643,-2137142926,-2136487093,-2135811151,-2135115106,-2134398964,-2133662733,-2132906418,-2132130028,-2131333570,-2130517051,-2129680478,-2128823860,-2127947205,-2127050521,-2126133816,-2125197099,-2124240379,-2123263664,-2122266965,-2121250290,-2120213650,-2119157053,-2118080509,-2116984030,-2115867624,-2114731304,-2113575078,-2112398959,-2111202957,-2109987084,-2108751350,-2107495769,-2106220350,-2104925108,-2103610052,-2102275197,-2100920555,-2099546137,-2098151959,-2096738031,-2095304368,-2093850983,-2092377891,-2090885104,-2089372636,-2087840503,-2086288718,-2084717297,-2083126253,-2081515602,-2079885359,-2078235539,-2076566158,-2074877232,-2073168776,-2071440807,-2069693340,-2067926393,-2066139982,-2064334123,-2062508834,-2060664132,-2058800034,-2056916558,-2055013722,-2053091543,-2051150039,-2049189229,-2047209132,-2045209765,-2043191148,-2041153300,-2039096240,-2037019987,-2034924560,-2032809981,-2030676267,-2028523440,-2026351520,-2024160527,-2021950482,-2019721406,-2017473319,-2015206243,-2012920199,-2010615209,-2008291294,-2005948476,-2003586778,-2001206221,-1998806828,-1996388621,-1993951623,-1991495858,-1989021348,-1986528117,-1984016187,-1981485584,-1978936329,-1976368449,-1973781966,-1971176905,-1968553290,-1965911147,-1963250500,-1960571374,-1957873794,-1955157786,-1952423376,-1949670588,-1946899449,-1944109986,-1941302224,-1938476189,-1935631909,-1932769410,-1929888719,-1926989863,-1924072869,-1921137766,-1918184579,-1915213339,-1912224071,-1909216805,-1906191569,-1903148391,-1900087299,-1897008324,-1893911493,-1890796835,-1887664381,-1884514160,-1881346200,-1878160533,-1874957188,-1871736195,-1868497584,-1865241387,-1861967633,-1858676353,-1855367579,-1852041342,-1848697672,-1845336602,-1841958163,-1838562387,-1835149305,-1831718950,-1828271354,-1824806550,-1821324571,-1817825448,-1814309215,-1810775905,-1807225552,-1803658188,-1800073847,-1796472564,-1792854371,-1789219303,-1785567395,-1781898680,-1778213193,-1774510969,-1770792043,-1767056449,-1763304223,-1759535400,-1755750016,-1751948106,-1748129706,-1744294851,-1740443579,-1736575926,-1732691926,-1728791618,-1724875039,-1720942223,-1716993210,-1713028036,-1709046738,-1705049354,-1701035921,-1697006477,-1692961061,-1688899710,-1684822462,-1680729356,-1676620430,-1672495724,-1668355275,-1664199123,-1660027307,-1655839866,-1651636840,-1647418268,-1643184190,-1638934645,-1634669674,-1630389317,-1626093615,-1621782607,-1617456334,-1613114836,-1608758156,-1604386334,-1599999410,-1595597426,-1591180424,-1586748446,-1582301532,-1577839725,-1573363067,-1568871600,-1564365365,-1559844407,-1555308767,-1550758487,-1546193611,-1541614182,-1537020242,-1532411836,-1527789006,-1523151796,-1518500249,-1513834409,-1509154321,-1504460028,-1499751575,-1495029005,-1490292363,-1485541694,-1480777043,-1475998454,-1471205973,-1466399644,-1461579512,-1456745624,-1451898024,-1447036759,-1442161873,-1437273413,-1432371425,-1427455955,-1422527049,-1417584754,-1412629116,-1407660182,-1402677998,-1397682612,-1392674071,-1387652420,-1382617709,-1377569984,-1372509293,-1367435684,-1362349203,-1357249900,-1352137821,-1347013016,-1341875532,-1336725418,-1331562722,-1326387493,-1321199779,-1315999630,-1310787094,-1305562221,-1300325059,-1295075658,-1289814067,-1284540336,-1279254514,-1273956652,-1268646799,-1263325004,-1257991319,-1252645793,-1247288476,-1241919420,-1236538674,-1231146290,-1225742317,-1220326808,-1214899812,-1209461381,-1204011566,-1198550418,-1193077990,-1187594331,-1182099495,-1176593532,-1171076494,-1165548434,-1160009404,-1154459455,-1148898639,-1143327010,-1137744620,-1132151520,-1126547764,-1120933405,-1115308495,-1109673088,-1104027236,-1098370992,-1092704410,-1087027543,-1081340444,-1075643168,-1069935767,-1064218295,-1058490807,-1052753356,-1047005996,-1041248781,-1035481765,-1029705003,-1023918549,-1018122458,-1012316783,-1006501580,-1000676904,-994842809,-988999350,-983146582,-977284561,-971413341,-965532977,-959643526,-953745042,-947837581,-941921199,-935995951,-930061893,-924119081,-918167571,-912207418,-906238680,-900261412,-894275670,-888281511,-882278991,-876268167,-870249094,-864221831,-858186434,-852142958,-846091463,-840032003,-833964637,-827889421,-821806412,-815715669,-809617248,-803511206,-797397601,-791276491,-785147933,-779011985,-772868705,-766718150,-760560379,-754395449,-748223418,-742044344,-735858286,-729665302,-723465451,-717258789,-711045377,-704825271,-698598532,-692365217,-686125386,-679879096,-673626407,-667367378,-661102067,-654830534,-648552837,-642269036,-635979189,-629683356,-623381597,-617073970,-610760535,-604441351,-598116478,-591785975,-585449902,-579108319,-572761285,-566408859,-560051103,-553688075,-547319836,-540946445,-534567962,-528184448,-521795962,-515402565,-509004317,-502601278,-496193509,-489781068,-483364018,-476942419,-470516330,-464085812,-457650927,-451211733,-444768293,-438320666,-431868914,-425413097,-418953276,-412489511,-406021864,-399550395,-393075166,-386596236,-380113668,-373627522,-367137860,-360644742,-354148229,-347648383,-341145265,-334638935,-328129456,-321616889,-315101294,-308582733,-302061268,-295536960,-289009870,-282480060,-275947591,-269412525,-262874923,-256334846,-249792357,-243247517,-236700387,-230151030,-223599506,-217045877,-210490205,-203932553,-197372981,-190811551,-184248325,-177683365,-171116732,-164548489,-157978697,-151407418,-144834714,-138260647,-131685278,-125108670,-118530884,-111951983,-105372028,-98791081,-92209204,-85626459,-79042909,-72458614,-65873638,-59288041,-52701886,-46115236,-39528151,-32940694,-26352927,-19764912,-13176711,-6588386 };
uint16_t bitRevLUT[] = { 0x0,0x400,0x200,0x600,0x100,0x500,0x300,0x700,0x80,0x480,0x280,0x680,0x180,0x580,0x380,0x780,0x40,0x440,0x240,0x640,0x140,0x540,0x340,0x740,0xc0,0x4c0,0x2c0,0x6c0,0x1c0,0x5c0,0x3c0,0x7c0,0x20,0x420,0x220,0x620,0x120,0x520,0x320,0x720,0xa0,0x4a0,0x2a0,0x6a0,0x1a0,0x5a0,0x3a0,0x7a0,0x60,0x460,0x260,0x660,0x160,0x560,0x360,0x760,0xe0,0x4e0,0x2e0,0x6e0,0x1e0,0x5e0,0x3e0,0x7e0,0x10,0x410,0x210,0x610,0x110,0x510,0x310,0x710,0x90,0x490,0x290,0x690,0x190,0x590,0x390,0x790,0x50,0x450,0x250,0x650,0x150,0x550,0x350,0x750,0xd0,0x4d0,0x2d0,0x6d0,0x1d0,0x5d0,0x3d0,0x7d0,0x30,0x430,0x230,0x630,0x130,0x530,0x330,0x730,0xb0,0x4b0,0x2b0,0x6b0,0x1b0,0x5b0,0x3b0,0x7b0,0x70,0x470,0x270,0x670,0x170,0x570,0x370,0x770,0xf0,0x4f0,0x2f0,0x6f0,0x1f0,0x5f0,0x3f0,0x7f0,0x8,0x408,0x208,0x608,0x108,0x508,0x308,0x708,0x88,0x488,0x288,0x688,0x188,0x588,0x388,0x788,0x48,0x448,0x248,0x648,0x148,0x548,0x348,0x748,0xc8,0x4c8,0x2c8,0x6c8,0x1c8,0x5c8,0x3c8,0x7c8,0x28,0x428,0x228,0x628,0x128,0x528,0x328,0x728,0xa8,0x4a8,0x2a8,0x6a8,0x1a8,0x5a8,0x3a8,0x7a8,0x68,0x468,0x268,0x668,0x168,0x568,0x368,0x768,0xe8,0x4e8,0x2e8,0x6e8,0x1e8,0x5e8,0x3e8,0x7e8,0x18,0x418,0x218,0x618,0x118,0x518,0x318,0x718,0x98,0x498,0x298,0x698,0x198,0x598,0x398,0x798,0x58,0x458,0x258,0x658,0x158,0x558,0x358,0x758,0xd8,0x4d8,0x2d8,0x6d8,0x1d8,0x5d8,0x3d8,0x7d8,0x38,0x438,0x238,0x638,0x138,0x538,0x338,0x738,0xb8,0x4b8,0x2b8,0x6b8,0x1b8,0x5b8,0x3b8,0x7b8,0x78,0x478,0x278,0x678,0x178,0x578,0x378,0x778,0xf8,0x4f8,0x2f8,0x6f8,0x1f8,0x5f8,0x3f8,0x7f8,0x4,0x404,0x204,0x604,0x104,0x504,0x304,0x704,0x84,0x484,0x284,0x684,0x184,0x584,0x384,0x784,0x44,0x444,0x244,0x644,0x144,0x544,0x344,0x744,0xc4,0x4c4,0x2c4,0x6c4,0x1c4,0x5c4,0x3c4,0x7c4,0x24,0x424,0x224,0x624,0x124,0x524,0x324,0x724,0xa4,0x4a4,0x2a4,0x6a4,0x1a4,0x5a4,0x3a4,0x7a4,0x64,0x464,0x264,0x664,0x164,0x564,0x364,0x764,0xe4,0x4e4,0x2e4,0x6e4,0x1e4,0x5e4,0x3e4,0x7e4,0x14,0x414,0x214,0x614,0x114,0x514,0x314,0x714,0x94,0x494,0x294,0x694,0x194,0x594,0x394,0x794,0x54,0x454,0x254,0x654,0x154,0x554,0x354,0x754,0xd4,0x4d4,0x2d4,0x6d4,0x1d4,0x5d4,0x3d4,0x7d4,0x34,0x434,0x234,0x634,0x134,0x534,0x334,0x734,0xb4,0x4b4,0x2b4,0x6b4,0x1b4,0x5b4,0x3b4,0x7b4,0x74,0x474,0x274,0x674,0x174,0x574,0x374,0x774,0xf4,0x4f4,0x2f4,0x6f4,0x1f4,0x5f4,0x3f4,0x7f4,0xc,0x40c,0x20c,0x60c,0x10c,0x50c,0x30c,0x70c,0x8c,0x48c,0x28c,0x68c,0x18c,0x58c,0x38c,0x78c,0x4c,0x44c,0x24c,0x64c,0x14c,0x54c,0x34c,0x74c,0xcc,0x4cc,0x2cc,0x6cc,0x1cc,0x5cc,0x3cc,0x7cc,0x2c,0x42c,0x22c,0x62c,0x12c,0x52c,0x32c,0x72c,0xac,0x4ac,0x2ac,0x6ac,0x1ac,0x5ac,0x3ac,0x7ac,0x6c,0x46c,0x26c,0x66c,0x16c,0x56c,0x36c,0x76c,0xec,0x4ec,0x2ec,0x6ec,0x1ec,0x5ec,0x3ec,0x7ec,0x1c,0x41c,0x21c,0x61c,0x11c,0x51c,0x31c,0x71c,0x9c,0x49c,0x29c,0x69c,0x19c,0x59c,0x39c,0x79c,0x5c,0x45c,0x25c,0x65c,0x15c,0x55c,0x35c,0x75c,0xdc,0x4dc,0x2dc,0x6dc,0x1dc,0x5dc,0x3dc,0x7dc,0x3c,0x43c,0x23c,0x63c,0x13c,0x53c,0x33c,0x73c,0xbc,0x4bc,0x2bc,0x6bc,0x1bc,0x5bc,0x3bc,0x7bc,0x7c,0x47c,0x27c,0x67c,0x17c,0x57c,0x37c,0x77c,0xfc,0x4fc,0x2fc,0x6fc,0x1fc,0x5fc,0x3fc,0x7fc,0x2,0x402,0x202,0x602,0x102,0x502,0x302,0x702,0x82,0x482,0x282,0x682,0x182,0x582,0x382,0x782,0x42,0x442,0x242,0x642,0x142,0x542,0x342,0x742,0xc2,0x4c2,0x2c2,0x6c2,0x1c2,0x5c2,0x3c2,0x7c2,0x22,0x422,0x222,0x622,0x122,0x522,0x322,0x722,0xa2,0x4a2,0x2a2,0x6a2,0x1a2,0x5a2,0x3a2,0x7a2,0x62,0x462,0x262,0x662,0x162,0x562,0x362,0x762,0xe2,0x4e2,0x2e2,0x6e2,0x1e2,0x5e2,0x3e2,0x7e2,0x12,0x412,0x212,0x612,0x112,0x512,0x312,0x712,0x92,0x492,0x292,0x692,0x192,0x592,0x392,0x792,0x52,0x452,0x252,0x652,0x152,0x552,0x352,0x752,0xd2,0x4d2,0x2d2,0x6d2,0x1d2,0x5d2,0x3d2,0x7d2,0x32,0x432,0x232,0x632,0x132,0x532,0x332,0x732,0xb2,0x4b2,0x2b2,0x6b2,0x1b2,0x5b2,0x3b2,0x7b2,0x72,0x472,0x272,0x672,0x172,0x572,0x372,0x772,0xf2,0x4f2,0x2f2,0x6f2,0x1f2,0x5f2,0x3f2,0x7f2,0xa,0x40a,0x20a,0x60a,0x10a,0x50a,0x30a,0x70a,0x8a,0x48a,0x28a,0x68a,0x18a,0x58a,0x38a,0x78a,0x4a,0x44a,0x24a,0x64a,0x14a,0x54a,0x34a,0x74a,0xca,0x4ca,0x2ca,0x6ca,0x1ca,0x5ca,0x3ca,0x7ca,0x2a,0x42a,0x22a,0x62a,0x12a,0x52a,0x32a,0x72a,0xaa,0x4aa,0x2aa,0x6aa,0x1aa,0x5aa,0x3aa,0x7aa,0x6a,0x46a,0x26a,0x66a,0x16a,0x56a,0x36a,0x76a,0xea,0x4ea,0x2ea,0x6ea,0x1ea,0x5ea,0x3ea,0x7ea,0x1a,0x41a,0x21a,0x61a,0x11a,0x51a,0x31a,0x71a,0x9a,0x49a,0x29a,0x69a,0x19a,0x59a,0x39a,0x79a,0x5a,0x45a,0x25a,0x65a,0x15a,0x55a,0x35a,0x75a,0xda,0x4da,0x2da,0x6da,0x1da,0x5da,0x3da,0x7da,0x3a,0x43a,0x23a,0x63a,0x13a,0x53a,0x33a,0x73a,0xba,0x4ba,0x2ba,0x6ba,0x1ba,0x5ba,0x3ba,0x7ba,0x7a,0x47a,0x27a,0x67a,0x17a,0x57a,0x37a,0x77a,0xfa,0x4fa,0x2fa,0x6fa,0x1fa,0x5fa,0x3fa,0x7fa,0x6,0x406,0x206,0x606,0x106,0x506,0x306,0x706,0x86,0x486,0x286,0x686,0x186,0x586,0x386,0x786,0x46,0x446,0x246,0x646,0x146,0x546,0x346,0x746,0xc6,0x4c6,0x2c6,0x6c6,0x1c6,0x5c6,0x3c6,0x7c6,0x26,0x426,0x226,0x626,0x126,0x526,0x326,0x726,0xa6,0x4a6,0x2a6,0x6a6,0x1a6,0x5a6,0x3a6,0x7a6,0x66,0x466,0x266,0x666,0x166,0x566,0x366,0x766,0xe6,0x4e6,0x2e6,0x6e6,0x1e6,0x5e6,0x3e6,0x7e6,0x16,0x416,0x216,0x616,0x116,0x516,0x316,0x716,0x96,0x496,0x296,0x696,0x196,0x596,0x396,0x796,0x56,0x456,0x256,0x656,0x156,0x556,0x356,0x756,0xd6,0x4d6,0x2d6,0x6d6,0x1d6,0x5d6,0x3d6,0x7d6,0x36,0x436,0x236,0x636,0x136,0x536,0x336,0x736,0xb6,0x4b6,0x2b6,0x6b6,0x1b6,0x5b6,0x3b6,0x7b6,0x76,0x476,0x276,0x676,0x176,0x576,0x376,0x776,0xf6,0x4f6,0x2f6,0x6f6,0x1f6,0x5f6,0x3f6,0x7f6,0xe,0x40e,0x20e,0x60e,0x10e,0x50e,0x30e,0x70e,0x8e,0x48e,0x28e,0x68e,0x18e,0x58e,0x38e,0x78e,0x4e,0x44e,0x24e,0x64e,0x14e,0x54e,0x34e,0x74e,0xce,0x4ce,0x2ce,0x6ce,0x1ce,0x5ce,0x3ce,0x7ce,0x2e,0x42e,0x22e,0x62e,0x12e,0x52e,0x32e,0x72e,0xae,0x4ae,0x2ae,0x6ae,0x1ae,0x5ae,0x3ae,0x7ae,0x6e,0x46e,0x26e,0x66e,0x16e,0x56e,0x36e,0x76e,0xee,0x4ee,0x2ee,0x6ee,0x1ee,0x5ee,0x3ee,0x7ee,0x1e,0x41e,0x21e,0x61e,0x11e,0x51e,0x31e,0x71e,0x9e,0x49e,0x29e,0x69e,0x19e,0x59e,0x39e,0x79e,0x5e,0x45e,0x25e,0x65e,0x15e,0x55e,0x35e,0x75e,0xde,0x4de,0x2de,0x6de,0x1de,0x5de,0x3de,0x7de,0x3e,0x43e,0x23e,0x63e,0x13e,0x53e,0x33e,0x73e,0xbe,0x4be,0x2be,0x6be,0x1be,0x5be,0x3be,0x7be,0x7e,0x47e,0x27e,0x67e,0x17e,0x57e,0x37e,0x77e,0xfe,0x4fe,0x2fe,0x6fe,0x1fe,0x5fe,0x3fe,0x7fe,0x1,0x401,0x201,0x601,0x101,0x501,0x301,0x701,0x81,0x481,0x281,0x681,0x181,0x581,0x381,0x781,0x41,0x441,0x241,0x641,0x141,0x541,0x341,0x741,0xc1,0x4c1,0x2c1,0x6c1,0x1c1,0x5c1,0x3c1,0x7c1,0x21,0x421,0x221,0x621,0x121,0x521,0x321,0x721,0xa1,0x4a1,0x2a1,0x6a1,0x1a1,0x5a1,0x3a1,0x7a1,0x61,0x461,0x261,0x661,0x161,0x561,0x361,0x761,0xe1,0x4e1,0x2e1,0x6e1,0x1e1,0x5e1,0x3e1,0x7e1,0x11,0x411,0x211,0x611,0x111,0x511,0x311,0x711,0x91,0x491,0x291,0x691,0x191,0x591,0x391,0x791,0x51,0x451,0x251,0x651,0x151,0x551,0x351,0x751,0xd1,0x4d1,0x2d1,0x6d1,0x1d1,0x5d1,0x3d1,0x7d1,0x31,0x431,0x231,0x631,0x131,0x531,0x331,0x731,0xb1,0x4b1,0x2b1,0x6b1,0x1b1,0x5b1,0x3b1,0x7b1,0x71,0x471,0x271,0x671,0x171,0x571,0x371,0x771,0xf1,0x4f1,0x2f1,0x6f1,0x1f1,0x5f1,0x3f1,0x7f1,0x9,0x409,0x209,0x609,0x109,0x509,0x309,0x709,0x89,0x489,0x289,0x689,0x189,0x589,0x389,0x789,0x49,0x449,0x249,0x649,0x149,0x549,0x349,0x749,0xc9,0x4c9,0x2c9,0x6c9,0x1c9,0x5c9,0x3c9,0x7c9,0x29,0x429,0x229,0x629,0x129,0x529,0x329,0x729,0xa9,0x4a9,0x2a9,0x6a9,0x1a9,0x5a9,0x3a9,0x7a9,0x69,0x469,0x269,0x669,0x169,0x569,0x369,0x769,0xe9,0x4e9,0x2e9,0x6e9,0x1e9,0x5e9,0x3e9,0x7e9,0x19,0x419,0x219,0x619,0x119,0x519,0x319,0x719,0x99,0x499,0x299,0x699,0x199,0x599,0x399,0x799,0x59,0x459,0x259,0x659,0x159,0x559,0x359,0x759,0xd9,0x4d9,0x2d9,0x6d9,0x1d9,0x5d9,0x3d9,0x7d9,0x39,0x439,0x239,0x639,0x139,0x539,0x339,0x739,0xb9,0x4b9,0x2b9,0x6b9,0x1b9,0x5b9,0x3b9,0x7b9,0x79,0x479,0x279,0x679,0x179,0x579,0x379,0x779,0xf9,0x4f9,0x2f9,0x6f9,0x1f9,0x5f9,0x3f9,0x7f9,0x5,0x405,0x205,0x605,0x105,0x505,0x305,0x705,0x85,0x485,0x285,0x685,0x185,0x585,0x385,0x785,0x45,0x445,0x245,0x645,0x145,0x545,0x345,0x745,0xc5,0x4c5,0x2c5,0x6c5,0x1c5,0x5c5,0x3c5,0x7c5,0x25,0x425,0x225,0x625,0x125,0x525,0x325,0x725,0xa5,0x4a5,0x2a5,0x6a5,0x1a5,0x5a5,0x3a5,0x7a5,0x65,0x465,0x265,0x665,0x165,0x565,0x365,0x765,0xe5,0x4e5,0x2e5,0x6e5,0x1e5,0x5e5,0x3e5,0x7e5,0x15,0x415,0x215,0x615,0x115,0x515,0x315,0x715,0x95,0x495,0x295,0x695,0x195,0x595,0x395,0x795,0x55,0x455,0x255,0x655,0x155,0x555,0x355,0x755,0xd5,0x4d5,0x2d5,0x6d5,0x1d5,0x5d5,0x3d5,0x7d5,0x35,0x435,0x235,0x635,0x135,0x535,0x335,0x735,0xb5,0x4b5,0x2b5,0x6b5,0x1b5,0x5b5,0x3b5,0x7b5,0x75,0x475,0x275,0x675,0x175,0x575,0x375,0x775,0xf5,0x4f5,0x2f5,0x6f5,0x1f5,0x5f5,0x3f5,0x7f5,0xd,0x40d,0x20d,0x60d,0x10d,0x50d,0x30d,0x70d,0x8d,0x48d,0x28d,0x68d,0x18d,0x58d,0x38d,0x78d,0x4d,0x44d,0x24d,0x64d,0x14d,0x54d,0x34d,0x74d,0xcd,0x4cd,0x2cd,0x6cd,0x1cd,0x5cd,0x3cd,0x7cd,0x2d,0x42d,0x22d,0x62d,0x12d,0x52d,0x32d,0x72d,0xad,0x4ad,0x2ad,0x6ad,0x1ad,0x5ad,0x3ad,0x7ad,0x6d,0x46d,0x26d,0x66d,0x16d,0x56d,0x36d,0x76d,0xed,0x4ed,0x2ed,0x6ed,0x1ed,0x5ed,0x3ed,0x7ed,0x1d,0x41d,0x21d,0x61d,0x11d,0x51d,0x31d,0x71d,0x9d,0x49d,0x29d,0x69d,0x19d,0x59d,0x39d,0x79d,0x5d,0x45d,0x25d,0x65d,0x15d,0x55d,0x35d,0x75d,0xdd,0x4dd,0x2dd,0x6dd,0x1dd,0x5dd,0x3dd,0x7dd,0x3d,0x43d,0x23d,0x63d,0x13d,0x53d,0x33d,0x73d,0xbd,0x4bd,0x2bd,0x6bd,0x1bd,0x5bd,0x3bd,0x7bd,0x7d,0x47d,0x27d,0x67d,0x17d,0x57d,0x37d,0x77d,0xfd,0x4fd,0x2fd,0x6fd,0x1fd,0x5fd,0x3fd,0x7fd,0x3,0x403,0x203,0x603,0x103,0x503,0x303,0x703,0x83,0x483,0x283,0x683,0x183,0x583,0x383,0x783,0x43,0x443,0x243,0x643,0x143,0x543,0x343,0x743,0xc3,0x4c3,0x2c3,0x6c3,0x1c3,0x5c3,0x3c3,0x7c3,0x23,0x423,0x223,0x623,0x123,0x523,0x323,0x723,0xa3,0x4a3,0x2a3,0x6a3,0x1a3,0x5a3,0x3a3,0x7a3,0x63,0x463,0x263,0x663,0x163,0x563,0x363,0x763,0xe3,0x4e3,0x2e3,0x6e3,0x1e3,0x5e3,0x3e3,0x7e3,0x13,0x413,0x213,0x613,0x113,0x513,0x313,0x713,0x93,0x493,0x293,0x693,0x193,0x593,0x393,0x793,0x53,0x453,0x253,0x653,0x153,0x553,0x353,0x753,0xd3,0x4d3,0x2d3,0x6d3,0x1d3,0x5d3,0x3d3,0x7d3,0x33,0x433,0x233,0x633,0x133,0x533,0x333,0x733,0xb3,0x4b3,0x2b3,0x6b3,0x1b3,0x5b3,0x3b3,0x7b3,0x73,0x473,0x273,0x673,0x173,0x573,0x373,0x773,0xf3,0x4f3,0x2f3,0x6f3,0x1f3,0x5f3,0x3f3,0x7f3,0xb,0x40b,0x20b,0x60b,0x10b,0x50b,0x30b,0x70b,0x8b,0x48b,0x28b,0x68b,0x18b,0x58b,0x38b,0x78b,0x4b,0x44b,0x24b,0x64b,0x14b,0x54b,0x34b,0x74b,0xcb,0x4cb,0x2cb,0x6cb,0x1cb,0x5cb,0x3cb,0x7cb,0x2b,0x42b,0x22b,0x62b,0x12b,0x52b,0x32b,0x72b,0xab,0x4ab,0x2ab,0x6ab,0x1ab,0x5ab,0x3ab,0x7ab,0x6b,0x46b,0x26b,0x66b,0x16b,0x56b,0x36b,0x76b,0xeb,0x4eb,0x2eb,0x6eb,0x1eb,0x5eb,0x3eb,0x7eb,0x1b,0x41b,0x21b,0x61b,0x11b,0x51b,0x31b,0x71b,0x9b,0x49b,0x29b,0x69b,0x19b,0x59b,0x39b,0x79b,0x5b,0x45b,0x25b,0x65b,0x15b,0x55b,0x35b,0x75b,0xdb,0x4db,0x2db,0x6db,0x1db,0x5db,0x3db,0x7db,0x3b,0x43b,0x23b,0x63b,0x13b,0x53b,0x33b,0x73b,0xbb,0x4bb,0x2bb,0x6bb,0x1bb,0x5bb,0x3bb,0x7bb,0x7b,0x47b,0x27b,0x67b,0x17b,0x57b,0x37b,0x77b,0xfb,0x4fb,0x2fb,0x6fb,0x1fb,0x5fb,0x3fb,0x7fb,0x7,0x407,0x207,0x607,0x107,0x507,0x307,0x707,0x87,0x487,0x287,0x687,0x187,0x587,0x387,0x787,0x47,0x447,0x247,0x647,0x147,0x547,0x347,0x747,0xc7,0x4c7,0x2c7,0x6c7,0x1c7,0x5c7,0x3c7,0x7c7,0x27,0x427,0x227,0x627,0x127,0x527,0x327,0x727,0xa7,0x4a7,0x2a7,0x6a7,0x1a7,0x5a7,0x3a7,0x7a7,0x67,0x467,0x267,0x667,0x167,0x567,0x367,0x767,0xe7,0x4e7,0x2e7,0x6e7,0x1e7,0x5e7,0x3e7,0x7e7,0x17,0x417,0x217,0x617,0x117,0x517,0x317,0x717,0x97,0x497,0x297,0x697,0x197,0x597,0x397,0x797,0x57,0x457,0x257,0x657,0x157,0x557,0x357,0x757,0xd7,0x4d7,0x2d7,0x6d7,0x1d7,0x5d7,0x3d7,0x7d7,0x37,0x437,0x237,0x637,0x137,0x537,0x337,0x737,0xb7,0x4b7,0x2b7,0x6b7,0x1b7,0x5b7,0x3b7,0x7b7,0x77,0x477,0x277,0x677,0x177,0x577,0x377,0x777,0xf7,0x4f7,0x2f7,0x6f7,0x1f7,0x5f7,0x3f7,0x7f7,0xf,0x40f,0x20f,0x60f,0x10f,0x50f,0x30f,0x70f,0x8f,0x48f,0x28f,0x68f,0x18f,0x58f,0x38f,0x78f,0x4f,0x44f,0x24f,0x64f,0x14f,0x54f,0x34f,0x74f,0xcf,0x4cf,0x2cf,0x6cf,0x1cf,0x5cf,0x3cf,0x7cf,0x2f,0x42f,0x22f,0x62f,0x12f,0x52f,0x32f,0x72f,0xaf,0x4af,0x2af,0x6af,0x1af,0x5af,0x3af,0x7af,0x6f,0x46f,0x26f,0x66f,0x16f,0x56f,0x36f,0x76f,0xef,0x4ef,0x2ef,0x6ef,0x1ef,0x5ef,0x3ef,0x7ef,0x1f,0x41f,0x21f,0x61f,0x11f,0x51f,0x31f,0x71f,0x9f,0x49f,0x29f,0x69f,0x19f,0x59f,0x39f,0x79f,0x5f,0x45f,0x25f,0x65f,0x15f,0x55f,0x35f,0x75f,0xdf,0x4df,0x2df,0x6df,0x1df,0x5df,0x3df,0x7df,0x3f,0x43f,0x23f,0x63f,0x13f,0x53f,0x33f,0x73f,0xbf,0x4bf,0x2bf,0x6bf,0x1bf,0x5bf,0x3bf,0x7bf,0x7f,0x47f,0x27f,0x67f,0x17f,0x57f,0x37f,0x77f,0xff,0x4ff,0x2ff,0x6ff,0x1ff,0x5ff,0x3ff,0x7ff };


#define FIX_MULT(a,b) (int64_t)(((int64_t)(a >> 16)*(int64_t)(b >> 15))) //Split the >>31 up in >>15 and >>16 before multiplication to avoid overflows

#define N 2048 //MUST BE A POWER OF TWO
#define N_POW 11
#define sinInt(a) sinArr[a % 2048]
#define cosInt(a) sinArr[(a + 512) % 2048] //Define cos in terms of sin to save memory space

struct complexNum { //Standard struct for containing complex numbers
	int64_t real = 0;
	int64_t imag = 0;
};

complexNum complexMult(complexNum inp1, complexNum inp2) { //TODO: make more efficient??
	complexNum outp;

	//(a + bi) * (c + di)
	outp.real = FIX_MULT(inp1.real, inp2.real) - FIX_MULT(inp1.imag, inp2.imag); //Take a*c + b*d*i^2 = a*c - b * d (i^2 = -1)
	outp.imag = FIX_MULT(inp1.real, inp2.imag) + FIX_MULT(inp1.imag, inp2.real); //Take a*d + b*c
	return outp;
}

complexNum complexAdd(complexNum inp1, complexNum inp2) {
	complexNum outp;
	outp.real = inp1.real + inp2.real; //Add the real and imaginary parts together
	outp.imag = inp1.imag + inp2.imag;
	return outp;
}

complexNum complexSubtract(complexNum inp1, complexNum inp2) {
	complexNum outp;
	outp.real = inp1.real - inp2.real; //Subtract the real and imaginary parts
	outp.imag = inp1.imag - inp2.imag;
	return outp;
}

complexNum getTwiddle(uint16_t n, uint16_t k) {
	complexNum outp;
	outp.real = cosInt(k * (N / n));
	outp.imag = -1 * sinInt(k * (N / n));
	return outp;
}

double complLength(complexNum inp) {
	//double output = pow(((double)inp.real)/2147483647, 2) + pow(((double)inp.imag)/2147483647, 2);
	double output = ((double)(FIX_MULT(inp.real, inp.real) + FIX_MULT(inp.imag, inp.imag))) / 2147483647;
	return sqrt(output);
}

void fftComplete(int32_t* dataPtr, complexNum* output) {
	complexNum betweenLayerMem1[N] = {};
	complexNum betweenLayerMem2[N] = {};
	complexNum* betweenLayer1 = betweenLayerMem1; //Make pointers to the betweenLayer memories
	complexNum* betweenLayer2 = betweenLayerMem2; //Make pointers to the betweenLayer memories
	complexNum unevenStore[N >> 1] = {};
	//complexNum evenStore[N >> 1] = {};
	for (uint16_t i = 0; i < N; i++) {
		betweenLayer1[i].real = *(dataPtr + bitRevLUT[i]); //Sort the inputs to make make the algorithm more easy and efficient (google FFT butterfly)
	}
	for (uint16_t fftSizeCnt = 2; fftSizeCnt <= N; fftSizeCnt <<= 1) { //Cycle through all the fft layers, starting with small DFT's of 2 and ending with a big DFT of size N
		for (uint16_t i = 0; i < N; i += fftSizeCnt) { 
			//Not neccessary to do this, it is much more efficient to acces betweenLayer1[p + i] directly when the even part is needed
			//for (uint16_t p = 0; p < (fftSizeCnt >> 1); p++) { //Cycle through positive part of the DFT
			//	evenStore[p] = betweenLayer1[p + i];
			//}
			for (uint16_t p = 0; p < (fftSizeCnt >> 1); p++) { //Cycle through negative part of the DFT
				unevenStore[p] = complexMult(betweenLayer1[p + i + (fftSizeCnt >> 1)], getTwiddle(fftSizeCnt, p)); //Multiply by twiddle factor
			}
			for (uint16_t p = 0; p < fftSizeCnt; p++) {
				if (p < (fftSizeCnt >> 1)) {
					betweenLayer2[p + i] = complexAdd(unevenStore[p], betweenLayer1[p + i]); //Make use of the DFT symmetry
				}
				else {
					betweenLayer2[p + i] = complexSubtract(betweenLayer1[p + i - (fftSizeCnt >> 1)], unevenStore[p - (fftSizeCnt >> 1)]); //Make use of the DFT symmetry
				}
			}
		}
		complexNum* tempPtrStore = betweenLayer1; //Switch betweenLayer1 and betweenLayer2 to efficiently reuse intermediate FFT results
		betweenLayer1 = betweenLayer2;
		betweenLayer2 = tempPtrStore;
	}
	
	memcpy(output, betweenLayer1, N * sizeof(complexNum)); //We want to know the last layer, but since betweenLayer1 and betweenLayer2's pointers have been switched we need to take betweenlayer1
}

int main() {
	int32_t data[2048] = {};
	complexNum finalRes[N] = {};
	
	for (int i = 0; i < 2048; i++) { //Generate a square wave in order to test the fft
		
		
	}
	/*
	for (int i = 0; i < 2048; i++) { //Generate a square wave in order to test the fft
		if ((i % 20) < 10) {
			data[i] = -10000;
		}
		else {
			data[i] = 10000;
		}
	}
	*/
	
	fftComplete(data, finalRes);
	for (uint16_t i = 0; i < N; i++) {
		std::cout << complLength(finalRes[i]) << '\n';
	}

	while (1);
	return 0;
}